<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>QR_test</title>
</head>
<body>
   
	<!-- 掃描用 -->
    	<div  style="height:50%;width:100%"><div id="qr-reader" style="width:100%"></div></div>
	<!-- 條碼顯示的內容顯示在 qr-reader-results -->
	<!--
	<div  style="height:70%;width:100%" id="qr-reader-results"><h1 id="qrtext"></h1></div>
	-->
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.0.3/html5-qrcode.min.js"></script>
<script>
	function sendMsg(mm) {
		window.parent.postMessage(
			{data:mm},
			"*"
			);
	}
	const html5QrCode = new Html5Qrcode("qr-reader");
	const qrCodeSuccessCallback = (decodedText, decodedResult) => {
	  /* 處理成功掃描 */  
		//let return_url="http://www.everanhospital.com.tw:4119/qrcode/index_1029.html?";
		//decodedText=encodeURIComponent(decodedText)
		//return_url+="text="+decodedText;
		//document.getElementById("qrtext").innerHTML = decodedText;
		//window.location.href = return_url;
		sendMsg(decodedText);

	};
	const config = { fps: 3, 
			//qrbox: 800 ,
			aspectRatio: 1};
	// 直接開啟後面鏡頭
	html5QrCode.start({ 
	  facingMode: "environment" }, 
	  config, qrCodeSuccessCallback); 
</script>

</html>
